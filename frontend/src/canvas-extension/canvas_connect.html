<div id="ubc-clubs-tray">
    
    <!-- VIEW 0: Login (Shown First) -->
    <div id="view-login" style="display: block; padding: 40px 30px;">
        <h2 style="margin:0 0 10px 0; font-size: 1.6rem; color: #2D3B45; text-align: center;">Welcome to Social Spaces</h2>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">Enter your Canvas API token to get started</p>
        
        <div style="margin-bottom: 20px;">
            <label style="display:block; font-weight:bold; margin-bottom: 8px;">Canvas API Token:</label>
            <input type="password" id="login-token" placeholder="Enter your Canvas API token" style="width:100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; font-family:inherit;">
        </div>

        <button id="login-submit-btn" style="width:100%; background:#0374B5; color:white; padding:12px; border:none; border-radius:6px; cursor:pointer; font-weight: bold; font-size: 1rem;">
            Login
        </button>
        
        <div id="login-error" style="margin-top: 15px; color: red; text-align: center; display: none;"></div>
    </div>

    <!-- Main Content (Hidden until logged in) -->
    <div id="main-content" style="display: none;">
        <!-- Header -->
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; border-bottom: 1px solid #eee; background: white;">
            <h2 style="margin:0; font-size: 1.4rem; color: #2D3B45;">Social Spaces</h2>
            <div style="display: flex; align-items: center; gap: 15px;">
                <button id="logout-btn" style="background:none; border:none; color: #666; cursor:pointer; font-size: 0.9rem; padding: 5px 10px;">Logout</button>
                <button id="ubc-tray-close" style="background:none; border:none; font-size: 1.8rem; cursor:pointer; color: #888;">&times;</button>
            </div>
        </div>

    <!-- VIEW 1: Onboarding (Sidebar Style) -->
    <div id="view-onboarding" style="display: block;">
        <h3 style="margin-top: 0;">Find Your Community</h3>
        <p style="font-size:0.95em; color:#666; margin-bottom: 20px;">Tell us about yourself to see what's happening on campus.</p>
        
        <div style="margin-bottom: 15px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Year:</label>
            <select id="ai-year" style="width:100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px;">
                <option value="1st Year">1st Year</option>
                <option value="2nd Year">2nd Year</option>
                <option value="3rd Year">3rd Year</option>
                <option value="4th Year+">4th Year+</option>
                <option value="Grad Student">Grad Student</option>
            </select>
        </div>

        <div style="margin-bottom: 15px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Classes:</label>
            <input type="text" id="ai-classes" placeholder="COSC 101, MATH 200" style="width:100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px;">
        </div>

        <div style="margin-bottom: 20px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Interests:</label>
            <textarea id="ai-interests" rows="3" placeholder="I like hiking, chess, and coding..." style="width:100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-family:inherit;"></textarea>
        </div>

        <button id="ai-submit-btn" style="width:100%; background:#0374B5; color:white; padding:12px; border:none; border-radius:6px; cursor:pointer; font-weight: bold; font-size: 1rem;">
            Generate Recommendations
        </button>
        
        <div id="ai-results-area" style="margin-top: 25px;"></div>
    </div>

    <!-- VIEW 2: Dashboard (Full Width) -->
    <div id="view-dashboard" style="display: none; height: 100%; flex-direction: column;">
        
        <!-- Tabs -->
        <div style="display: flex; background: white; border-bottom: 1px solid #ddd; padding: 0 20px;">
            <button class="nav-tab active" data-target="tab-school" style="flex:1; padding: 15px;">School</button>
            <button class="nav-tab" data-target="tab-clubs" style="flex:1; padding: 15px;">Clubs</button>
            <button class="nav-tab" data-target="tab-class" style="flex:1; padding: 15px;">Class</button>
            <button class="nav-tab" data-target="tab-groups" style="flex:1; padding: 15px;">Groups</button>
        </div>

        <!-- Content Area -->
        <div id="dashboard-content">
            
            <!-- 1. School Feed -->
            <div id="tab-school" class="tab-content">
                <h3 style="margin-top:0;">Campus Feed</h3>
                
                <!-- School Wide Announcement (New) -->
                <div class="dashboard-card" style="border-left: 4px solid #0374B5; background-color: #f8fbff;">
                    <div style="display:flex; justify-content:space-between;">
                        <strong>Campus Announcement</strong>
                        <span style="font-size:0.8em; color:#0374B5;">Pinned</span>
                    </div>
                    <p style="margin: 5px 0;">Looking to get involved? Check out the <a href="https://students.ok.ubc.ca/career-experience/experience-involvement-hub/" target="_blank" style="color:#0374B5; font-weight:bold; text-decoration:none;">Experience Involvement Hub</a> for volunteering, co-ops, and career building opportunities.</p>
                </div>

                <div id="feed-posts" style="margin-bottom: 30px;"></div>
                <h3>Upcoming Events</h3>
                <div id="feed-events"></div>
            </div>

            <!-- 2. Clubs Directory -->
            <div id="tab-clubs" class="tab-content" style="display:none;">
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <input type="text" id="club-search" placeholder="Search for clubs, sports, or hobbies..." style="flex:1; padding: 12px; border:1px solid #ccc; border-radius:6px;">
                    <button id="redo-onboarding-btn" style="padding: 10px 20px; cursor:pointer; background: #eee; border:none; border-radius:6px;">Preferences</button>
                </div>
                <div id="all-clubs-list"></div>
            </div>

            <!-- 3. Class Announcements -->
            <div id="tab-class" class="tab-content" style="display:none;">
                <h3>My Classes</h3>
                <div id="all-classes-list"></div>
            </div>

            <!-- 4. Group Chats -->
            <div id="tab-groups" class="tab-content" style="display:none;">
                <h3>My Chats</h3>
                <div id="my-joined-chats" style="margin-bottom:30px;">
                    <p style="color:grey; font-style:italic;">You haven't joined any groups yet.</p>
                </div>
                <h3>Available Groups</h3>
                <div id="available-group-chats"></div>
            </div>

        </div>
    </div>
    </div>
</div>