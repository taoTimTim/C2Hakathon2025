<!-- The Main Container -->
<div id="ubc-clubs-tray" class="ic-app-header__tray">
    
    <!-- Header Section -->
    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #ccc;">
        <h2 style="margin:0; font-size: 1.2rem; color: #2D3B45;">Social Spaces</h2>
        <button id="ubc-tray-close" style="background:none; border:none; font-size: 1.5rem; cursor:pointer; color: #666;">&times;</button>
    </div>

    <!-- VIEW 1: Onboarding Form (Default View) -->
    <div id="view-onboarding" style="padding: 20px; display: block;">
        <h3 style="margin-top: 0;">Find Your Community</h3>
        <p style="font-size:0.9em; color:#666; margin-bottom: 15px;">Tell us about yourself to see what's happening on campus.</p>
        
        <div style="margin-bottom: 15px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Year:</label>
            <select id="ai-year" style="width:100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                <option value="1st Year">1st Year</option>
                <option value="2nd Year">2nd Year</option>
                <option value="3rd Year">3rd Year</option>
                <option value="4th Year+">4th Year+</option>
                <option value="Grad Student">Grad Student</option>
            </select>
        </div>

        <div style="margin-bottom: 15px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Classes:</label>
            <input type="text" id="ai-classes" placeholder="COSC 101, MATH 200" style="width:94%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
        </div>

        <div style="margin-bottom: 20px;">
            <label style="display:block; font-weight:bold; margin-bottom: 5px;">Interests:</label>
            <textarea id="ai-interests" rows="3" placeholder="I like hiking, chess, and coding..." style="width:94%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
        </div>

        <button id="ai-submit-btn" style="width:100%; background:#0374B5; color:white; padding:12px; border:none; border-radius:4px; cursor:pointer; font-weight: bold;">
            Generate Recommendations
        </button>
        
        <!-- AI Results Container -->
        <div id="ai-results-area" style="margin-top: 20px;"></div>
    </div>

    <!-- VIEW 2: Main Dashboard (Hidden by default) -->
    <div id="view-dashboard" style="display: none; height: calc(100% - 60px); flex-direction: column;">
        
        <!-- Navigation Tabs -->
        <div style="display: flex; background: #f5f5f5; border-bottom: 1px solid #ddd;">
            <button class="nav-tab active" data-target="tab-school" style="flex:1; padding: 10px; border:none; cursor:pointer; background:white; border-bottom: 2px solid #0374B5;">School</button>
            <button class="nav-tab" data-target="tab-clubs" style="flex:1; padding: 10px; border:none; cursor:pointer; background:none;">Clubs</button>
            <button class="nav-tab" data-target="tab-class" style="flex:1; padding: 10px; border:none; cursor:pointer; background:none;">Class</button>
            <button class="nav-tab" data-target="tab-groups" style="flex:1; padding: 10px; border:none; cursor:pointer; background:none;">Groups</button>
        </div>

        <!-- Tab Content Areas -->
        <div id="dashboard-content" style="flex: 1; overflow-y: auto; padding: 15px;">
            
            <!-- 1. School Wide (Inbox/Events) -->
            <div id="tab-school" class="tab-content">
                <h4 style="margin-top:0;">Campus Feed</h4>
                <div id="feed-posts"></div>
                <h4 style="margin-top:20px;">Upcoming Events</h4>
                <div id="feed-events"></div>
            </div>

            <!-- 2. Clubs (Directory & Search) -->
            <div id="tab-clubs" class="tab-content" style="display:none;">
                <div style="display: flex; gap: 5px; margin-bottom: 15px;">
                    <input type="text" id="club-search" placeholder="Search clubs..." style="flex:1; padding: 8px; border:1px solid #ccc; border-radius:4px;">
                    <button id="redo-onboarding-btn" style="font-size: 0.8em; padding: 5px; cursor:pointer;">⚙️ Prefs</button>
                </div>
                <div id="all-clubs-list"></div>
            </div>

            <!-- 3. Classwide (Mock Posts) -->
            <div id="tab-class" class="tab-content" style="display:none;">
                <h4 style="margin-top:0;">Class Announcements</h4>
                <div class="post-box" style="background:#fff; border:1px solid #ddd; padding:10px; border-radius:5px; margin-bottom:10px;">
                    <strong>Prof. Smith (COSC 101)</strong>
                    <p style="margin:5px 0;">Don't forget the midterm is next Tuesday!</p>
                    <small style="color:grey;">2 hours ago</small>
                </div>
                 <div class="post-box" style="background:#fff; border:1px solid #ddd; padding:10px; border-radius:5px; margin-bottom:10px;">
                    <strong>Teaching Assistant</strong>
                    <p style="margin:5px 0;">Office hours moved to 4 PM today.</p>
                    <small style="color:grey;">Yesterday</small>
                </div>
            </div>

            <!-- 4. Group Chats -->
            <div id="tab-groups" class="tab-content" style="display:none;">
                <h4 style="margin-top:0;">My Chats</h4>
                <div id="my-joined-chats">
                    <p style="color:grey; font-style:italic;">You haven't joined any groups yet.</p>
                </div>
                
                <h4 style="margin-top:20px;">Available Groups</h4>
                <div id="available-group-chats"></div>
            </div>

        </div>
    </div>
</div>